\chapter{Introduction}
\label{chap:introduction}
FPGA-based designs often incorporate one or more general purpose soft processors. As the range of FPGA applications broadens and evolves, it is likely that the performance demand from soft processors will increase. A key performance enhancing technique that even simple general purpose processors use is branch prediction. Without branch prediction, a branch has to execute completely before the processor can fetch the instructions that follow. Branch prediction eliminates these stalls by guessing the target address of branches. Current state-of-the-art branch prediction techniques, e.g., TAGE~\cite{tage}, rely on dynamically collected information about past branch behaviour. Such techniques have been proven to be very effective even in deeply pipelined, highly speculative, high-performance custom processor designs.

Branch prediction has been extensively studied in the context of application specific custom logic (ASIC) implementations. Since the tradeoffs are different for reconfigurable logic, na\"ively porting ASIC-based branch predictors to FPGAs may prove slow and/or resource-inefficient. Accordingly, this work studies the FPGA implementation of several commonly used branch predictor designs and does so in the context of simple pipelined processors, the most commonly used general purpose soft processor architecture due to its excellent balance of performance  and resource cost. For this purpose, it assumes a pipelined processor implementation representative of Altera's Nios~II-f and investigates the performance and resource cost of various branch predictors. The analysis confirms that existing designs are not efficient nor high-performing on reconfigurable logic. Accordingly, this work proposes FPGA-specific modifications that improve accuracy, resource cost, or both.

This work proposes branch predictors for Nios~II-f. In more detail, this work makes the following contributions:
(1)~It studies the FPGA-implementation of Branch Target Buffers (BTB), including designs that fuse the BTB and the direction predictor and shows that, contrary to ASIC implementations, it is best to avoid a BTB and instead to calculate branch target addresses on-the-fly.
(2)~It studies the FPGA implementation of the three most commonly used branch direction predictors (DIR): bimodal~\cite{bimodal}, gshare, and gselect~\cite{McFarling}. The analysis corroborates the results of past studies showing that gshare achieves the best accuracy among the three for practical table sizes, but also shows that unlike an ASIC implementation, frequency suffers with gshare on FPGAs. It proposes \textit{gRselect}, an FPGA-friendly gselect implementation that uses a simple indexing scheme to outperform gshare by 11.4\%.
(3)~It studies the implementations of two advanced branch prediction schemes: perceptron and TAGE. It shows that TAGE is the most accurate, however, it is too slow for single-cycle access. This work proposes \textit{O-TAGE-SC}, an overriding TAGE predictor with a statistical corrector, that delivers 5.2\% better performance over the best performing gRselect.

